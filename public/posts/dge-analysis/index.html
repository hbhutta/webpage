<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <style>
      div {
        font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
      }

      pre, code {
        color: rgb(24, 174, 119);
        background-color: ;
      }

      #content {
        background-color: white;
        margin-left: 170pt;
        margin-right: 170pt;
        margin-top: 50pt;
      }
      #date {
        color: gray;
        font-size: small;
      }
    </style>
    <script type="text/javascript">
      window.MathJax = {
        tex: {
          inlineMath: [
            ["$", "$"],
            ["\\(", "\\)"],
          ], 
        },
      };
    </script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
  </head>
  <body>
    <div id="content">
      <h1>Differential Gene Expression (DGE) Analysis in R</h1>
      
      <hr>
<h1 id="background">Background</h1>
<p>In an RNA-seq experiment, we may have samples from different &ldquo;treatments&rdquo; or &ldquo;groups&rdquo;. For example, we could have a total of $10$ samples, with $5$ samples coming from the &ldquo;diseased&rdquo; group and the other $5$ samples coming from the healthy group &ndash; &ldquo;diseased&rdquo; in this context could refer to any disease (e.g. <a href="">COPD</a>). We may have more or less than two treatments. This is just a toy example.</p>
<p>With DGE analysis, we can identify which genes are <em>differentially expressed</em> across the treatments.</p>
<p>Suppose we have two samples $S_{1}$ and $S_{2}$ from different treatments, and for each we measure the expression level of gene $G_{1}$ and $G_{2}$, amongst othere genes. If the expression of $G_{1}$ is &ldquo;roughly&rdquo; the same in both $S_{1}$ and $S_{2}$, then we say that $G_{1}$ is not differentially expressed, at least with respect to these two samples. Suppose on the other hand that $G_{2}$ <em>is</em> differentially expressed &ndash; say it is more expressed in the sample $S_{1}$ from the diseased group than it is in the sample $S_{2}$ from the healthy group. This would indicate that $G_{2}$ somehow contributes to the development of the disease we are examining. This is useful knowledge because we can know refer back to biological literature about the function of gene $G_{2}$ in the organism we are studying and understand how that relates to the symptoms expressed by the disease.</p>
<h1 id="dge-analysis-in-r-with-edger-and-limma-voom">DGE Analysis in R with <code>edgeR</code> and <code>limma-voom</code></h1>
<p>In an RNA-seq experiment, DGE analysis is performed downstream of forming a count matrix that quantifies gene expression level (per gene, per sample)<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. <code>limma</code> is an R (Bioconductor) package for the analysis of microarray data. <code>voom</code> is a function in the <code>limma</code> package that transforms the count-data from an RNA-seq experiment into a specific object which can then be interacted with by <code>limma</code> functions as microarray data. This is stated in the <code>limma</code> <a href="https://bioconductor.org/packages/release/bioc/vignettes/limma/inst/doc/usersguide.pdf">user guide</a>:</p>
<blockquote>
<p><em>&ldquo;From version 3.9.19, limma includes functions to analyse RNA-seq experiments, demonstrated
in Case Study 11.8. The approach is to convert a table of sequence read counts into an expression
object which can then be analysed as for microarray data&rdquo;</em></p>
</blockquote>
<p>Specifically, <code>voom</code> returns an <code>EList</code> (i.e. Expression List) object with a component <code>E</code> which is the numeric matrix of normalized expression values (on the log2 scale).<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup><sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>. <code>voom</code> takes in as input un-normalized counts, which can possibly be estimated counts (i.e. not necessarily whole numbers), as generated by <code>Salmon</code> and <code>tximport</code>.</p>
<p>Naturally, one might ask what is so special about RNA-seq count data that it needs to undergo special processing (via <code>voom</code>) before being passed into <code>limma</code> functions. In other words, how is RNA-seq data different from microarray data? For one, RNA-seq data tends to follow the <a href="https://www.sciencedirect.com/topics/mathematics/negative-binomial-distribution">Negative Binomial Distribution</a> when the <code>limma</code> functions made for microarray data expect normally distributed data. The purpose of <code>limma</code> and <code>voom</code> i</p>
<p>The complicated part is <em>how</em> exactly <code>voom</code> transforms the RNA-seq count data so it becomes acceptable for <code>limma</code> functions.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Refer to my article on <a href="http://localhost:1313/posts/salmon-tximport/" title="Salmon and tximport"><code>Salmon</code> and <code>tximport</code></a> for an explanation of how to derive a count matrix from <code>Salmon</code>&rsquo;s transcript-level quantification using <code>tximport</code>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>From page 250 of the <a href="https://bioconductor.org/packages/release/bioc/manuals/limma/man/limma.pdf"><code>limma</code> reference manual</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Note that in statistics, (numeric) data is often log-scaled when the data can take on large values&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>
  </body>
</html>
